
==================================================
NEW TRAINING SESSION: 2025-02-04 18:38:25.501140
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: False
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': False, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}
"Epoch 1 || PSNR: 13.5244 (best 13.5244 @ 1) | SSIM: 0.3087 (best 0.3087 @ 1) | Loss: 126.2435 (best 126.2435 @ 1) | UCIQE: 0.2418 | UIQM: 3.1446"
"Epoch 2 || PSNR: 14.9422 (best 14.9422 @ 2) | SSIM: 0.3476 (best 0.3476 @ 2) | Loss: 92.0229 (best 92.0229 @ 2) | UCIQE: 0.3144 | UIQM: 3.1372"
"Epoch 3 || PSNR: 15.1396 (best 15.1396 @ 3) | SSIM: 0.3744 (best 0.3744 @ 3) | Loss: 87.9443 (best 87.9443 @ 3) | UCIQE: 0.3378 | UIQM: 3.1968"

==================================================
RESUMED TRAINING SESSION: 2025-02-04 19:03:58.410108
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}

==================================================
RESUMED TRAINING SESSION: 2025-02-04 19:04:55.502573
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}

==================================================
RESUMED TRAINING SESSION: 2025-02-04 19:06:05.753602
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}
"Epoch 4 || PSNR: 15.4585 (best 15.4585 @ 4) | SSIM: 0.3876 (best 0.3876 @ 4) | Loss: 83.6407 (best 83.6407 @ 4) | UCIQE: 0.3219 | UIQM: 3.1484"

==================================================
RESUMED TRAINING SESSION: 2025-02-05 21:04:34.897161
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}
"Epoch 5 || PSNR: 15.7108 (best 15.7108 @ 5) | SSIM: 0.4047 (best 0.4047 @ 5) | Loss: 78.9191 (best 78.9191 @ 5) | UCIQE: 0.3367 | UIQM: 3.2245"
"Epoch 6 || PSNR: 16.2064 (best 16.2064 @ 6) | SSIM: 0.4291 (best 0.4291 @ 6) | Loss: 69.9451 (best 69.9451 @ 6) | UCIQE: 0.3581 | UIQM: 3.2306"
"Epoch 7 || PSNR: 16.0702 (best 16.2064 @ 6) | SSIM: 0.4363 (best 0.4363 @ 7) | Loss: 74.0779 (best 69.9451 @ 6) | UCIQE: 0.3546 | UIQM: 3.2897"
"Epoch 8 || PSNR: 16.1874 (best 16.2064 @ 6) | SSIM: 0.4434 (best 0.4434 @ 8) | Loss: 71.2640 (best 69.9451 @ 6) | UCIQE: 0.3578 | UIQM: 3.2758"
"Epoch 9 || PSNR: 16.1718 (best 16.2064 @ 6) | SSIM: 0.4466 (best 0.4466 @ 9) | Loss: 71.7501 (best 69.9451 @ 6) | UCIQE: 0.3434 | UIQM: 3.3296"
"Epoch 10 || PSNR: 16.4316 (best 16.4316 @ 10) | SSIM: 0.4617 (best 0.4617 @ 10) | Loss: 66.4041 (best 66.4041 @ 10) | UCIQE: 0.3819 | UIQM: 3.3505"

==================================================
RESUMED TRAINING SESSION: 2025-02-05 21:21:06.849280
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}

==================================================
RESUMED TRAINING SESSION: 2025-02-05 21:23:10.993705
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}

==================================================
RESUMED TRAINING SESSION: 2025-02-05 21:24:22.739113
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 16 TRAINING.MIXED_PRECISION fp16 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 16
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: fp16
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 16, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'fp16'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}

==================================================
RESUMED TRAINING SESSION: 2025-02-05 21:27:29.352411
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 10 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 10
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: no
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 10, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'no'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}
"Epoch 11 || PSNR: 16.6819 (best 16.6819 @ 11) | SSIM: 0.4919 (best 0.4919 @ 11) | Loss: 61.8841 (best 61.8841 @ 11) | UCIQE: 0.3579 | UIQM: 3.4213"
"Epoch 12 || PSNR: 16.5439 (best 16.6819 @ 11) | SSIM: 0.4977 (best 0.4977 @ 12) | Loss: 64.0748 (best 61.8841 @ 11) | UCIQE: 0.3673 | UIQM: 3.3750"

==================================================
RESUMED TRAINING SESSION: 2025-02-05 21:35:40.427110
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 10 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 10
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: no
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 10, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'no'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}

==================================================
RESUMED TRAINING SESSION: 2025-02-05 21:37:24.668889
Command line: train.py --config_yaml=config.yml MODEL.NAME edge_v2 MODEL.SESSION freq_0_edge_0.01_ssim_0.9_mp LOSSES.USE_FREQ False LOSSES.SSIM_SCALE 0.9 OPTIM.BATCH_SIZE 10 OPTIM.NUM_EPOCHS 500 OPTIM.LR_INITIAL 2e-5 TRAINING.RESUME True
Configuration:
GPU: [0]
LOG:
  LOG_DIR: ./log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp
LOSSES:
  EDGE_SCALE: 0.01
  FREQ_SCALE: 0.05
  LPIPS_SCALE: 0.7
  PSNR_SCALE: 1.0
  SSIM_SCALE: 0.9
  USE_EDGE: True
  USE_FREQ: False
  USE_LPIPS: True
  USE_PSNR: True
  USE_SSIM: True
MODEL:
  DATASET_NAME: UIEB
  INPUT: raw
  INPUT_CHANNELS: 3
  NAME: edge_v2
  SESSION: freq_0_edge_0.01_ssim_0.9_mp
  TARGET: ref
OPTIM:
  BATCH_SIZE: 10
  BETA1: 0.5
  LR_INITIAL: 2e-05
  LR_MIN: 1e-06
  NEPOCH_DECAY: [100]
  NUM_EPOCHS: 500
  SEED: 3407
  WANDB: True
TESTING:
  INPUT: raw
  LOG_FILE: t01.txt
  RESULT_DIR: 
  SAVE_IMAGES: True
  TARGET: ref
  VAL_DIR: 
  WEIGHT: 
TRAINING:
  CLIP_GRAD: 0.0
  LOG_FILE: log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt
  MIXED_PRECISION: no
  ORI: False
  PS_H: 256
  PS_W: 256
  RESUME: True
  SAVE_DIR: ./checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp
  TRAIN_DIR: ./image_dirs/UIEB/train
  VAL_AFTER_EVERY: 1
  VAL_DIR: ./image_dirs/UIEB/val
  WEIGHT: 
VERBOSE: True
WANDB:
  
==================================================
Model Detailed Summary:
--------------------------------------------------
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
EdgeModel_V2                                       [1, 3, 256, 256]          --
├─SCBackbone: 1-1                                  [1, 64, 256, 256]         --
│    └─Sequential: 2-1                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-1             [1, 64, 256, 256]         9,472
│    │    └─GELU: 3-2                              [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-3             [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-4                              [1, 64, 256, 256]         --
│    └─SCEncoderBlock: 2-2                         [1, 64, 256, 256]         --
│    │    └─Sequential: 3-5                        [1, 64, 256, 256]         36,928
│    │    └─SCEdgeDetectionModule: 3-6             [1, 64, 256, 256]         14,080
│    │    └─SCAttention: 3-7                       [1, 64, 256, 256]         5,291
│    │    └─Dropout: 3-8                           [1, 64, 256, 256]         --
│    │    └─Sequential: 3-9                        [1, 64, 256, 256]         36,928
│    │    └─Identity: 3-10                         [1, 64, 256, 256]         --
│    └─MaxPool2d: 2-3                              [1, 64, 128, 128]         --
│    └─SCEncoderBlock: 2-4                         [1, 128, 128, 128]        --
│    │    └─Sequential: 3-11                       [1, 128, 128, 128]        73,856
│    │    └─SCEdgeDetectionModule: 3-12            [1, 128, 128, 128]        52,736
│    │    └─SCAttention: 3-13                      [1, 128, 128, 128]        20,723
│    │    └─Dropout: 3-14                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-15                       [1, 128, 128, 128]        147,584
│    │    └─ReflectionPaddingConv: 3-16            [1, 128, 128, 128]        8,320
│    └─MaxPool2d: 2-5                              [1, 128, 64, 64]          --
│    └─SCEncoderBlock: 2-6                         [1, 256, 64, 64]          --
│    │    └─Sequential: 3-17                       [1, 256, 64, 64]          295,168
│    │    └─SCEdgeDetectionModule: 3-18            [1, 256, 64, 64]          203,776
│    │    └─SCAttention: 3-19                      [1, 256, 64, 64]          82,307
│    │    └─Dropout: 3-20                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-21                       [1, 256, 64, 64]          590,080
│    │    └─ReflectionPaddingConv: 3-22            [1, 256, 64, 64]          33,024
│    └─MaxPool2d: 2-7                              [1, 256, 32, 32]          --
│    └─SCEncoderBlock: 2-8                         [1, 512, 32, 32]          --
│    │    └─Sequential: 3-23                       [1, 512, 32, 32]          1,180,160
│    │    └─SCEdgeDetectionModule: 3-24            [1, 512, 32, 32]          800,768
│    │    └─SCAttention: 3-25                      [1, 512, 32, 32]          328,355
│    │    └─Dropout: 3-26                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-27                       [1, 512, 32, 32]          2,359,808
│    │    └─ReflectionPaddingConv: 3-28            [1, 512, 32, 32]          131,584
│    └─SCDecoderBlock: 2-9                         [1, 256, 64, 64]          --
│    │    └─Upsample: 3-29                         [1, 512, 64, 64]          --
│    │    └─Sequential: 3-30                       [1, 512, 64, 64]          2,359,808
│    │    └─Sequential: 3-31                       [1, 768, 64, 64]          590,592
│    │    └─SCAttention: 3-32                      [1, 768, 64, 64]          738,243
│    │    └─Sequential: 3-33                       [1, 256, 64, 64]          2,359,808
│    └─SCDecoderBlock: 2-10                        [1, 128, 128, 128]        --
│    │    └─Upsample: 3-34                         [1, 256, 128, 128]        --
│    │    └─Sequential: 3-35                       [1, 256, 128, 128]        590,080
│    │    └─Sequential: 3-36                       [1, 384, 128, 128]        147,840
│    │    └─SCAttention: 3-37                      [1, 384, 128, 128]        184,851
│    │    └─Sequential: 3-38                       [1, 128, 128, 128]        590,080
│    └─SCDecoderBlock: 2-11                        [1, 64, 256, 256]         --
│    │    └─Upsample: 3-39                         [1, 128, 256, 256]        --
│    │    └─Sequential: 3-40                       [1, 128, 256, 256]        147,584
│    │    └─Sequential: 3-41                       [1, 192, 256, 256]        37,056
│    │    └─SCAttention: 3-42                      [1, 192, 256, 256]        46,395
│    │    └─Sequential: 3-43                       [1, 64, 256, 256]         147,584
│    └─Sequential: 2-12                            [1, 3, 256, 256]          --
│    │    └─ReflectionPaddingConv: 3-44            [1, 64, 256, 256]         36,928
│    │    └─GELU: 3-45                             [1, 64, 256, 256]         --
│    │    └─ReflectionPaddingConv: 3-46            [1, 3, 256, 256]          1,731
│    │    └─Sigmoid: 3-47                          [1, 3, 256, 256]          --
====================================================================================================
Total params: 14,426,456
Trainable params: 14,426,456
Non-trainable params: 0
Total mult-adds (G): 98.76
====================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1160.61
Params size (MB): 57.71
Estimated Total Size (MB): 1219.10
====================================================================================================

Total Parameters: 14,426,456
Trainable Parameters: 14,426,456

Training Configuration:
--------------------------------------------------
WANDB: {}
GPU: [0]
VERBOSE: True
MODEL: {'SESSION': 'freq_0_edge_0.01_ssim_0.9_mp', 'INPUT': 'raw', 'TARGET': 'ref', 'INPUT_CHANNELS': 3, 'NAME': 'edge_v2', 'DATASET_NAME': 'UIEB'}
OPTIM: {'BATCH_SIZE': 10, 'SEED': 3407, 'NUM_EPOCHS': 500, 'NEPOCH_DECAY': [100], 'LR_INITIAL': 2e-05, 'LR_MIN': 1e-06, 'BETA1': 0.5, 'WANDB': True}
TRAINING: {'VAL_AFTER_EVERY': 1, 'RESUME': True, 'WEIGHT': '', 'TRAIN_DIR': './image_dirs/UIEB/train', 'VAL_DIR': './image_dirs/UIEB/val', 'SAVE_DIR': './checkpoints/edge_v2/UIEB/freq_0_edge_0.01_ssim_0.9_mp', 'PS_W': 256, 'PS_H': 256, 'ORI': False, 'LOG_FILE': 'log_edge_v2_freq_0_edge_0.01_ssim_0.9_mp.txt', 'CLIP_GRAD': 0.0, 'MIXED_PRECISION': 'no'}
TESTING: {'INPUT': 'raw', 'TARGET': 'ref', 'VAL_DIR': '', 'WEIGHT': '', 'SAVE_IMAGES': True, 'RESULT_DIR': '', 'LOG_FILE': 't01.txt'}
LOG: {'LOG_DIR': './log/edge_v2/freq_0_edge_0.01_ssim_0.9_mp'}
LOSSES: {'USE_PSNR': True, 'PSNR_SCALE': 1.0, 'USE_SSIM': True, 'SSIM_SCALE': 0.9, 'USE_LPIPS': True, 'LPIPS_SCALE': 0.7, 'USE_EDGE': True, 'EDGE_SCALE': 0.01, 'USE_FREQ': False, 'FREQ_SCALE': 0.05}
